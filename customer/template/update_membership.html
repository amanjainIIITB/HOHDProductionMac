{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Welcome</title>
    </head>
    <script src="{% static 'common/common.js' %}"></script>
    <script>
        function onload_behaviour(){
            setDate("DOB", "{{DOB}}");
        }

        function oninput_contact_number(){
            user_entered_contact_number = document.getElementById('Contact_Number').value;
            autocomplete('Contact_Number', {{memberships|safe}});
            client_details = get_client_details_based_on_contact_number('Contact_Number', {{memberships|safe}});
            if(client_details != '' && {{Contact_Number}} != user_entered_contact_number)
            {
                document.getElementById('membership_contact').innerHTML="This contact number has already been assigned <b>"+client_details.Name+"</b>, try another Number";
                document.getElementById("submit_button").disabled = true;
            }    
            else
            {
                document.getElementById('membership_contact').innerHTML= "";
                document.getElementById("submit_button").disabled = false;
            }   
        }

        function oninput_custid(){
            entered_custid = document.getElementById('custID').value;
            client_details = get_client_details_based_on_clientID('custID', {{memberships|safe}});
            console.log(client_details);
            if(client_details != '' && entered_custid != "{{custID}}"){
                document.getElementById('custid_span').innerHTML="This Client ID has already been assigned <b>"+client_details.Name+"</b>, try another ID";
                document.getElementById("submit_button").disabled = true;
            }
            else{
                document.getElementById('custid_span').innerHTML= "";
                document.getElementById("submit_button").disabled = false;
            }
        }
    </script>
    {% load static %}
    <style>
        .transaction{
            width:180px;
            text-align:center;
        }
        th, td {
            width:150px;
            height:40px;
        }
    </style>
    <body onload="onload_behaviour()">

        {% if messages %}
            <script>
                {% for message in messages %}
                    alert("{{ message }}");
                {% endfor %}
            </script>
        {% endif %}
        {% include 'menubar.html' with active_menubar_item="NA" %}
        <h1>Update Membership</h1>
        <form autocomplete="off" method="post" action="/client/update_membership/{{custID}}/">
            {% csrf_token %}
            <table>
                <tr>
                    <td>
                        <label for="custID">Client ID</label>
                    </td>
                    <td>
                        <input oninput="oninput_custid()" type="text" id="custID" name="custID" value="{{custID}}" required>
                    </td>
                </tr>
                <tr>
                    <td><span id="custid_span"></span></td>
                </tr>
                <tr>
                    <td>
                        <label for="Contact_Number">Contact_Number</label>
                    </td>
                    <td>
                        <input oninput="oninput_custid()" type="text" id="Contact_Number" name="Contact_Number" value="{{Contact_Number}}" required>
                        <div id="suggestions">
                        </div>
                        <span id="custid_span"></span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Sex">Sex</label>
                    </td>
                    <td>
                        <select id="Sex" name="Sex" value="{{Sex}}">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Name">Name</label>
                    </td>
                    <td>
                        <input type="text" id="Name" name="Name" value="{{Name}}">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="DOB">Date of Birth</label>
                    </td>
                    <td>
                        <input type="date" id="DOB" name="DOB"">
                    </td>
                </tr>
            </table>
            <input type="submit" id="submit_button" value="Submit">
        </form>
    </body>
</html>
